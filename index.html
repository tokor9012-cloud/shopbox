<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Spaceman Pro VIP - GitHub Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { background-color: #0f172a; color: white; font-family: 'Segoe UI', sans-serif; overflow: hidden; }
        .bg-space { background: radial-gradient(circle at center, #2e1065 0%, #0f172a 100%); }
        #gameCanvas { width: 100%; height: 350px; }
        .glass { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(15px); border: 1px solid rgba(255,255,255,0.1); }
        .modal-bg { background: rgba(0,0,0,0.85); backdrop-filter: blur(8px); }
        .crash-anim { animation: shake 0.2s infinite; color: #ef4444 !important; }
        @keyframes shake { 0% { transform: translate(1px, 1px); } 50% { transform: translate(-1px, -2px); } 100% { transform: translate(1px, -1px); } }
        input { background: rgba(15, 23, 42, 0.8) !important; color: #fbbf24 !important; border: 1px solid #334155 !important; padding: 14px; border-radius: 16px; outline: none; width: 100%; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="bg-space h-screen flex flex-col">

    <div id="regModal" class="hidden fixed inset-0 z-[100] modal-bg flex items-center justify-center p-6">
        <div class="glass w-full max-w-sm p-8 rounded-[2rem] border-2 border-blue-500/30">
            <h2 class="text-2xl font-black text-blue-400 mb-6 text-center italic uppercase">Pendaftaran Akun</h2>
            <div class="space-y-4">
                <input type="text" id="regNama" placeholder="Nama Lengkap">
                <input type="number" id="regHp" placeholder="Nomor WhatsApp">
                <input type="password" id="regPass" placeholder="Kata Sandi">
                <button onclick="prosesDaftar()" class="w-full py-4 bg-blue-600 hover:bg-blue-500 text-white font-black rounded-2xl shadow-xl transition-all uppercase">Daftar Sekarang</button>
                <button onclick="tutupModal('regModal')" class="w-full text-gray-500 text-xs font-bold uppercase">Batal</button>
            </div>
        </div>
    </div>

    <div id="profModal" class="hidden fixed inset-0 z-[100] modal-bg flex items-center justify-center p-6">
        <div class="glass w-full max-w-sm p-8 rounded-[2rem] border-2 border-emerald-500/30 text-center">
            <div class="w-20 h-20 mx-auto rounded-full border-4 border-emerald-500 mb-4 overflow-hidden">
                <img id="profImg" src="">
            </div>
            <h2 id="profNama" class="text-xl font-black text-white uppercase tracking-wider">Guest</h2>
            <p id="profHp" class="text-emerald-400 text-sm font-mono mb-6">08xxxxxx</p>
            <button onclick="prosesLogout()" class="w-full py-4 bg-red-600/20 text-red-500 border border-red-500/50 font-black rounded-2xl mb-3">LOGOUT</button>
            <button onclick="tutupModal('profModal')" class="text-gray-500 text-xs font-bold">TUTUP</button>
        </div>
    </div>

    <div id="ownerModal" class="hidden fixed inset-0 z-[110] modal-bg flex items-center justify-center p-6">
        <div class="glass w-full max-w-sm p-6 rounded-[2rem] border-2 border-yellow-500">
            <h2 class="text-xl font-black text-yellow-500 mb-4 italic text-center uppercase">Owner Panel</h2>
            <div class="space-y-4">
                <div>
                    <label class="text-[10px] text-gray-400 font-bold ml-1">TARGET CRASH (X)</label>
                    <input type="number" id="targetInp" value="2.50" step="0.01">
                </div>
                <button onclick="saveOwner()" class="w-full py-4 bg-yellow-600 text-black font-black rounded-2xl uppercase">Update System</button>
                <button onclick="tutupModal('ownerModal')" class="w-full text-gray-500 text-xs font-bold">KELUAR</button>
            </div>
        </div>
    </div>

    <header class="p-5 flex justify-between items-center z-50">
        <button onclick="cekOwner()" class="w-10 h-10 flex items-center justify-center bg-white/5 rounded-full opacity-20"><i class="fas fa-cog"></i></button>
        <div class="bg-black/60 px-6 py-2 rounded-full border border-blue-500/40 shadow-lg">
            <span class="text-blue-400 font-bold text-xs mr-1">Rp</span>
            <span id="balDisplay" class="font-mono font-bold text-sm tracking-widest">0,00</span>
        </div>
        <button onclick="klikProfil()" class="w-10 h-10 rounded-full border-2 border-emerald-500 overflow-hidden bg-emerald-900/30">
            <img id="avatarHead" src="https://api.dicebear.com/7.x/bottts/svg?seed=Guest">
        </button>
    </header>

    <div class="relative flex-grow flex flex-col items-center justify-center overflow-hidden">
        <div id="multDisplay" class="text-8xl font-black text-white z-10 drop-shadow-[0_10px_10px_rgba(0,0,0,0.5)]">1.00x</div>
        <div id="statusTag" class="text-[10px] uppercase tracking-[0.5em] text-blue-300 mt-4 font-black">Ready to Launch</div>
        <canvas id="gameCanvas" class="absolute inset-0"></canvas>
        <div id="histBar" class="absolute bottom-10 left-0 w-full flex gap-2 px-6 overflow-x-auto no-scrollbar"></div>
    </div>

    <footer class="bg-[#121826] p-6 rounded-t-[3rem] shadow-2xl border-t border-white/5">
        <div class="grid grid-cols-2 gap-4 mb-6">
            <div onclick="simulasiDepo()" class="glass p-4 rounded-2xl flex items-center justify-between active:scale-95 transition-all">
                <div><p class="text-[9px] text-gray-400 font-bold uppercase">Saldo Anda</p><p class="text-emerald-400 font-bold text-xs mt-1">Isi Saldo</p></div>
                <i class="fas fa-plus-circle text-emerald-500"></i>
            </div>
            <div class="glass p-4 rounded-2xl">
                <p class="text-[9px] text-gray-400 font-bold uppercase text-center mb-1">Bet (Rp)</p>
                <input type="number" id="betAmount" value="2000" class="!p-0 !bg-transparent !border-none text-center text-yellow-500 font-black text-sm">
            </div>
        </div>
        <button id="btnMain" onclick="handleMain()" class="w-full py-5 bg-gradient-to-r from-emerald-500 to-teal-600 rounded-2xl text-xl font-black shadow-xl uppercase tracking-widest active:scale-95 transition-all">Pasang Taruhan</button>
    </footer>

    <audio id="sndFly" src="https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3" loop></audio>
    <audio id="sndExplode" src="https://assets.mixkit.co/active_storage/sfx/123/123-preview.mp3"></audio>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const sndFly = document.getElementById('sndFly');
        const sndExplode = document.getElementById('sndExplode');

        // LOCAL DATA
        let user = JSON.parse(localStorage.getItem('sp_user')) || null;
        let balance = parseFloat(localStorage.getItem('sp_bal')) || 0.00;
        let currentMult = 1.00;
        let targetCrash = 2.50;
        let isPlaying = false;
        let isCashedOut = false;
        let animation;
        let pos = { x: 50, y: 280 };
        let history = ["1.45x", "3.22x", "1.08x"];

        canvas.width = window.innerWidth;
        canvas.height = 350;

        function bukaModal(id) { document.getElementById(id).classList.remove('hidden'); }
        function tutupModal(id) { document.getElementById(id).classList.add('hidden'); }

        function updateUI() {
            document.getElementById('balDisplay').innerText = balance.toLocaleString('id-ID', {minimumFractionDigits: 2});
            localStorage.setItem('sp_bal', balance);
            const avatar = user ? `https://api.dicebear.com/7.x/bottts/svg?seed=${user.nama}` : `https://api.dicebear.com/7.x/bottts/svg?seed=Guest`;
            document.getElementById('avatarHead').src = avatar;
        }

        function klikProfil() {
            if(!user) bukaModal('regModal');
            else {
                document.getElementById('profNama').innerText = user.nama;
                document.getElementById('profHp').innerText = user.hp;
                document.getElementById('profImg').src = `https://api.dicebear.com/7.x/bottts/svg?seed=${user.nama}`;
                bukaModal('profModal');
            }
        }

        function prosesDaftar() {
            const nama = document.getElementById('regNama').value;
            const hp = document.getElementById('regHp').value;
            if(nama && hp) {
                user = { nama, hp };
                localStorage.setItem('sp_user', JSON.stringify(user));
                tutupModal('regModal');
                updateUI();
                alert("Berhasil Daftar!");
            }
        }

        function prosesLogout() {
            localStorage.removeItem('sp_user');
            user = null;
            tutupModal('profModal');
            updateUI();
        }

        function simulasiDepo() {
            const amt = prompt("Masukkan jumlah Deposit (Rp):", "50000");
            if(amt) { balance += parseFloat(amt); updateUI(); }
        }

        function drawRobot(x, y, state) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            // Trail
            ctx.beginPath(); ctx.setLineDash([5, 5]); ctx.moveTo(0, 320); ctx.quadraticCurveTo(canvas.width/2, 320, x, y);
            ctx.strokeStyle = state === 'crash' ? '#ef4444' : '#60a5fa'; ctx.lineWidth = 2; ctx.stroke();
            // Body
            ctx.fillStyle = state === 'crash' ? '#ef4444' : '#ffffff';
            ctx.beginPath(); ctx.arc(x, y, 14, 0, Math.PI*2); ctx.fill();
            ctx.fillStyle = (state === 'win') ? '#10b981' : '#3b82f6'; ctx.fillRect(x-12, y+15, 24, 20);
            if(state !== 'crash') {
                ctx.fillStyle = '#f59e0b'; ctx.beginPath(); ctx.moveTo(x-8, y+35); ctx.lineTo(x, y+50); ctx.lineTo(x+8, y+35); ctx.fill();
            }
        }

        function handleMain() {
            if(!user) return klikProfil();
            if(!isPlaying) mulaiTerbang();
            else if(!isCashedOut) laksanakanCashout();
        }

        function mulaiTerbang() {
            const bet = parseFloat(document.getElementById('betAmount').value);
            if(balance < bet) return alert("Saldo Kurang!");
            
            isPlaying = true; isCashedOut = false; balance -= bet; updateUI();
            currentMult = 1.00; pos = { x: 50, y: 280 };
            document.getElementById('btnMain').innerText = "CASH OUT";
            document.getElementById('btnMain').className = "w-full py-5 bg-gradient-to-r from-orange-500 to-red-600 rounded-2xl text-xl font-black uppercase";
            document.getElementById('statusTag').innerText = "Flying...";
            sndFly.play(); animate();
        }

        function animate() {
            if(currentMult >= targetCrash) { gameMeledak(); return; }
            currentMult += 0.01;
            document.getElementById('multDisplay').innerText = currentMult.toFixed(2) + "x";
            pos.x += (canvas.width / (targetCrash * 100)) * 0.9;
            pos.y -= (250 / (targetCrash * 100)) * 0.9;
            drawRobot(pos.x, pos.y, isCashedOut ? 'win' : 'flying');
            animation = requestAnimationFrame(animate);
        }

        function laksanakanCashout() {
            const bet = parseFloat(document.getElementById('betAmount').value);
            balance += bet * currentMult; isCashedOut = true; updateUI();
            document.getElementById('btnMain').innerText = "SUDAH CAIR";
            document.getElementById('btnMain').disabled = true;
            document.getElementById('btnMain').className = "w-full py-5 bg-gray-700 rounded-2xl text-xl font-black opacity-50";
            document.getElementById('statusTag').innerText = "Secured!";
        }

        function gameMeledak() {
            isPlaying = false; sndFly.pause(); sndExplode.play();
            cancelAnimationFrame(animation);
            document.getElementById('multDisplay').classList.add('crash-anim');
            document.getElementById('statusTag').innerText = "CRASHED!";
            drawRobot(pos.x, pos.y, 'crash');
            history.unshift(currentMult.toFixed(2) + "x");
            if(history.length > 5) history.pop();
            renderHist();
            setTimeout(resetGame, 3000);
        }

        function resetGame() {
            document.getElementById('multDisplay').className = "text-8xl font-black text-white z-10 drop-shadow-2xl";
            document.getElementById('btnMain').disabled = false;
            document.getElementById('btnMain').innerText = "Pasang Taruhan";
            document.getElementById('btnMain').className = "w-full py-5 bg-gradient-to-r from-emerald-500 to-teal-600 rounded-2xl text-xl font-black uppercase";
            document.getElementById('statusTag').innerText = "Ready to Launch";
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawRobot(50, 280, 'idle');
        }

        function renderHist() {
            const bar = document.getElementById('histBar');
            bar.innerHTML = '';
            history.forEach(h => {
                const span = document.createElement('span');
                span.className = "bg-white/10 border border-white/20 px-4 py-1 rounded-lg text-xs font-bold";
                span.innerText = h; bar.appendChild(span);
            });
        }

        function cekOwner() {
            if(prompt("Owner PIN:") === "123") bukaModal('ownerModal');
        }

        function saveOwner() {
            targetCrash = parseFloat(document.getElementById('targetInp').value);
            tutupModal('ownerModal');
        }

        updateUI(); renderHist(); drawRobot(50, 280, 'idle');
    </script>
</body>
</html>
