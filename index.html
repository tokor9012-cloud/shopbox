<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Spaceman Pro - Full System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { background-color: #0f172a; color: white; font-family: sans-serif; overflow: hidden; }
        .bg-space { background: radial-gradient(circle at center, #2e1065 0%, #0f172a 100%); }
        #gameCanvas { width: 100%; height: 320px; }
        .glass { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.1); }
        .modal-bg { background: rgba(0,0,0,0.9); backdrop-filter: blur(5px); }
        input { background: #1e293b !important; color: #fbbf24 !important; border: 1px solid #334155 !important; padding: 12px; border-radius: 12px; outline: none; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="bg-space h-screen flex flex-col">

    <div id="registerModal" class="hidden fixed inset-0 z-[110] modal-bg flex items-center justify-center p-6">
        <div class="glass w-full max-w-sm p-6 rounded-3xl border-2 border-blue-500">
            <h2 class="text-xl font-black text-blue-400 mb-6 text-center italic">PENDAFTARAN AKUN</h2>
            <div class="flex flex-col gap-4">
                <input type="text" id="regNama" placeholder="Nama Lengkap">
                <input type="number" id="regHp" placeholder="Nomor WhatsApp">
                <input type="password" id="regPass" placeholder="Kata Sandi">
                <button onclick="prosesDaftar()" class="w-full py-4 bg-blue-600 text-white font-black rounded-2xl shadow-lg uppercase">Daftar Sekarang</button>
                <button onclick="closeModal('registerModal')" class="text-gray-500 text-xs">Batal</button>
            </div>
        </div>
    </div>

    <div id="depositModal" class="hidden fixed inset-0 z-[110] modal-bg flex items-center justify-center p-6">
        <div class="glass w-full max-w-sm p-6 rounded-3xl border-2 border-emerald-500">
            <h2 class="text-xl font-black text-emerald-500 mb-6 text-center italic">DEPOSIT SALDO</h2>
            <div class="flex flex-col gap-4">
                <p class="text-xs text-gray-400 text-center font-bold">MINIMAL Rp 10.000</p>
                <input type="number" id="depAmount" placeholder="Jumlah (Contoh: 50000)">
                <button onclick="prosesDeposit()" class="w-full py-4 bg-emerald-600 text-white font-black rounded-2xl shadow-lg uppercase">Konfirmasi Deposit</button>
                <button onclick="closeModal('depositModal')" class="text-gray-500 text-xs text-center">Tutup</button>
            </div>
        </div>
    </div>

    <div id="wdModal" class="hidden fixed inset-0 z-[110] modal-bg flex items-center justify-center p-6">
        <div class="glass w-full max-w-sm p-6 rounded-3xl border-2 border-red-500">
            <h2 class="text-xl font-black text-red-500 mb-6 text-center italic">WITHDRAW (TARIK)</h2>
            <div class="flex flex-col gap-4">
                <p class="text-xs text-gray-400 text-center font-bold">MINIMAL Rp 50.000</p>
                <input type="number" id="wdAmount" placeholder="Jumlah Penarikan">
                <button onclick="prosesWithdraw()" class="w-full py-4 bg-red-600 text-white font-black rounded-2xl shadow-lg uppercase">Tarik Saldo</button>
                <button onclick="closeModal('wdModal')" class="text-gray-500 text-xs text-center">Tutup</button>
            </div>
        </div>
    </div>

    <div id="adminModal" class="hidden fixed inset-0 z-[120] modal-bg flex items-center justify-center p-6">
        <div class="glass w-full max-w-sm p-6 rounded-3xl border-2 border-yellow-500">
            <h2 class="text-xl font-black text-yellow-500 mb-4 italic text-center">OWNER PANEL</h2>
            <div class="flex flex-col gap-4">
                <input type="number" id="targetInput" value="2.50" step="0.01" placeholder="Target Crash">
                <button onclick="saveAdmin()" class="w-full py-4 bg-yellow-600 text-black font-black rounded-2xl uppercase">Simpan Target</button>
                <button onclick="closeModal('adminModal')" class="text-gray-500 text-xs">Tutup</button>
            </div>
        </div>
    </div>

    <header class="p-4 flex justify-between items-center">
        <button onclick="requestAccess()" class="w-10 h-10 flex items-center justify-center bg-white/5 rounded-full"><i class="fas fa-cog text-gray-600"></i></button>
        <div class="bg-black/40 px-4 py-1.5 rounded-full border border-blue-500/50">
            <span class="text-blue-400 font-bold text-xs">Rp</span>
            <span id="balanceDisplay" class="font-bold text-sm tracking-widest ml-1">0,00</span>
        </div>
        <button onclick="openModal('registerModal')" class="w-10 h-10 rounded-full border border-emerald-500 overflow-hidden shadow-lg shadow-emerald-500/20">
            <img src="https://api.dicebear.com/7.x/bottts/svg?seed=Robot" alt="avatar">
        </button>
    </header>

    <div class="relative flex-grow flex flex-col items-center justify-center">
        <div id="multDisplay" class="text-7xl font-black text-white z-10 drop-shadow-2xl">1.00x</div>
        <p id="statusLabel" class="text-[10px] uppercase tracking-[0.4em] text-blue-300 mt-2 font-black">Siap Bermain</p>
        <canvas id="gameCanvas" class="absolute inset-0"></canvas>
        <div id="historyBar" class="absolute bottom-10 left-0 w-full flex gap-2 px-6 overflow-x-auto no-scrollbar"></div>
    </div>

    <div class="flex gap-4 px-6 mb-4">
        <button onclick="openModal('depositModal')" class="flex-1 py-2 glass rounded-xl text-[10px] font-black uppercase text-emerald-400 border-emerald-500/30"><i class="fas fa-wallet mr-2"></i>Deposit</button>
        <button onclick="openModal('wdModal')" class="flex-1 py-2 glass rounded-xl text-[10px] font-black uppercase text-red-400 border-red-500/30"><i class="fas fa-hand-holding-usd mr-2"></i>Withdraw</button>
    </div>

    <footer class="bg-[#1e1b4b] p-6 rounded-t-[40px] shadow-2xl border-t border-white/5">
        <div class="grid grid-cols-2 gap-4 mb-6">
            <div class="glass p-3 rounded-2xl">
                <p class="text-[9px] text-gray-400 font-black uppercase">Auto Cashout</p>
                <div class="flex justify-between font-bold mt-1 text-sm"><span>2.00x</span><i class="fas fa-chevron-right text-gray-700"></i></div>
            </div>
            <div class="glass p-3 rounded-2xl">
                <p class="text-[9px] text-gray-400 font-black uppercase">Taruhan (Rp)</p>
                <input type="number" id="betInput" value="2000" class="w-full bg-transparent font-bold text-yellow-500 outline-none border-none p-0 text-sm">
            </div>
        </div>
        <button id="actionBtn" onclick="handleAction()" class="w-full py-5 bg-gradient-to-r from-emerald-500 to-teal-600 rounded-2xl text-xl font-black shadow-xl uppercase tracking-widest active:scale-95 transition-all">Pasang Taruhan</button>
    </footer>

    <audio id="flySound" src="https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3" loop></audio>
    <audio id="crashSound" src="https://assets.mixkit.co/active_storage/sfx/123/123-preview.mp3"></audio>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const balanceDisplay = document.getElementById('balanceDisplay');
        const actionBtn = document.getElementById('actionBtn');
        const flySound = document.getElementById('flySound');
        const crashSound = document.getElementById('crashSound');

        // STATE
        let balance = 0;
        let targetCrash = 2.50;
        let currentMult = 1.00;
        let isPlaying = false;
        let hasCashedOut = false;
        let animation;
        let robotPos = { x: 50, y: 250 };
        let history = ["5.13x", "1.06x", "1.43x", "2.53x"];

        canvas.width = window.innerWidth;
        canvas.height = 320;

        // MODAL HELPERS
        function openModal(id) { document.getElementById(id).classList.remove('hidden'); }
        function closeModal(id) { document.getElementById(id).classList.add('hidden'); }

        // LOGIKA TRANSAKSI & AKUN
        function prosesDaftar() {
            const nama = document.getElementById('regNama').value;
            if(!nama) return alert("Isi data dengan lengkap!");
            alert("Halo " + nama + ", Akun berhasil dibuat!");
            closeModal('registerModal');
        }

        function prosesDeposit() {
            const amt = parseFloat(document.getElementById('depAmount').value);
            if(amt < 10000) return alert("Minimal Deposit Rp 10.000");
            balance += amt;
            updateUI();
            alert("Deposit Berhasil!");
            closeModal('depositModal');
        }

        function prosesWithdraw() {
            const amt = parseFloat(document.getElementById('wdAmount').value);
            if(amt > balance) return alert("Saldo tidak cukup!");
            if(amt < 50000) return alert("Minimal WD Rp 50.000");
            balance -= amt;
            updateUI();
            alert("Penarikan Sedang Diproses!");
            closeModal('wdModal');
        }

        function requestAccess() {
            const pin = prompt("Owner PIN:");
            if(pin === "123") openModal('adminModal');
            else alert("Akses Ditolak!");
        }

        // GAME LOGIC
        function drawRobot(x, y, state) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.beginPath();
            ctx.setLineDash([5, 5]); ctx.moveTo(0, 300); ctx.quadraticCurveTo(canvas.width/2, 300, x, y);
            ctx.strokeStyle = state === 'crash' ? '#ef4444' : '#60a5fa';
            ctx.lineWidth = 2; ctx.stroke();
            ctx.fillStyle = (state === 'crash') ? '#ef4444' : '#ffffff';
            ctx.beginPath(); ctx.arc(x, y, 12, 0, Math.PI*2); ctx.fill();
            ctx.fillStyle = (state === 'win') ? '#10b981' : '#3b82f6'; ctx.fillRect(x-10, y+12, 20, 18);
            if(state !== 'crash') {
                ctx.fillStyle = '#f59e0b'; ctx.beginPath(); ctx.moveTo(x-6, y+30); ctx.lineTo(x, y+45); ctx.lineTo(x+6, y+30); ctx.fill();
            }
        }

        function handleAction() {
            if (!isPlaying) startGame();
            else if (!hasCashedOut) cashOut();
        }

        function startGame() {
            const betVal = parseFloat(document.getElementById('betInput').value);
            if(balance < betVal) return alert("Saldo Anda Kurang, Silakan Deposit!");
            isPlaying = true; hasCashedOut = false; balance -= betVal; updateUI();
            currentMult = 1.00; robotPos = { x: 50, y: 250 };
            actionBtn.innerText = "CASH OUT";
            actionBtn.className = "w-full py-5 bg-gradient-to-r from-orange-500 to-red-600 rounded-2xl text-xl font-black";
            flySound.play(); animate();
        }

        function animate() {
            if (currentMult >= targetCrash) { crashGame(); return; }
            currentMult += 0.01;
            document.getElementById('multDisplay').innerText = currentMult.toFixed(2) + "x";
            robotPos.x += (canvas.width / (targetCrash * 100)) * 0.8;
            robotPos.y -= (220 / (targetCrash * 100)) * 0.8;
            drawRobot(robotPos.x, robotPos.y, hasCashedOut ? 'win' : 'flying');
            animation = requestAnimationFrame(animate);
        }

        function cashOut() {
            const betVal = parseFloat(document.getElementById('betInput').value);
            balance += betVal * currentMult;
            hasCashedOut = true; updateUI();
            actionBtn.innerText = "BERHASIL!";
            actionBtn.disabled = true;
            actionBtn.className = "w-full py-5 bg-gray-700 rounded-2xl text-xl font-black opacity-50";
        }

        function crashGame() {
            isPlaying = false; flySound.pause(); crashSound.play();
            cancelAnimationFrame(animation);
            document.getElementById('multDisplay').classList.add('crash-text');
            drawRobot(robotPos.x, robotPos.y, 'crash');
            addHistory(currentMult.toFixed(2) + "x");
            setTimeout(resetGame, 3000);
        }

        function resetGame() {
            document.getElementById('multDisplay').className = "text-7xl font-black text-white z-10 drop-shadow-2xl";
            actionBtn.disabled = false; actionBtn.innerText = "PASANG TARUHAN";
            actionBtn.className = "w-full py-5 bg-gradient-to-r from-emerald-500 to-teal-600 rounded-2xl text-xl font-black";
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawRobot(50, 250, 'idle');
        }

        function addHistory(val) {
            history.unshift(val); if(history.length > 5) history.pop();
            renderHistory();
        }

        function renderHistory() {
            const bar = document.getElementById('historyBar');
            bar.innerHTML = '';
            history.forEach(item => {
                const v = parseFloat(item);
                let color = v >= 2 ? "bg-purple-600/30 border-purple-500 text-purple-400" : "bg-blue-600/30 border-blue-500 text-blue-400";
                const span = document.createElement('span');
                span.className = `${color} border px-3 py-1 rounded-lg text-[10px] font-bold`;
                span.innerText = item; bar.appendChild(span);
            });
        }

        function updateUI() {
            balanceDisplay.innerText = balance.toLocaleString('id-ID', {minimumFractionDigits: 2});
        }

        function saveAdmin() {
            targetCrash = parseFloat(document.getElementById('targetInput').value);
            closeModal('adminModal');
        }

        renderHistory(); updateUI(); drawRobot(50, 250, 'idle');
    </script>
</body>
</html>
